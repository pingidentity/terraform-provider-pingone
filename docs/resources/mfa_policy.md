---
page_title: "pingone_mfa_policy Resource - terraform-provider-pingone"
subcategory: "MFA"
description: |-
  Resource to create and manage MFA Policies in a PingOne Environment.
---

# pingone_mfa_policy (Resource)

Resource to create and manage MFA Policies in a PingOne Environment.

## Example Usage - Basic Policy

The following example enables the FIDO2 and TOTP Authenticator factors. 

```terraform
resource "pingone_environment" "my_environment" {
  # ...
}

resource "pingone_mfa_policy" "my_awesome_mfa_policy" {
  environment_id = pingone_environment.my_environment.id
  name           = "My awesome MFA policy"

  mobile {
    enabled = false
  }

  totp {
    enabled = true
  }

  fido2 {
    enabled = true
  }

  sms {
    enabled = false
  }

  voice {
    enabled = false
  }

  email {
    enabled = false
  }
}
```

## Example Usage - Mobile Authenticator

The following example configures and enables the Mobile Authenticator (using PingOne MFA SDK) and Authenticator TOTP factors. 

```terraform
resource "pingone_environment" "my_environment" {
  # ...
}

resource "pingone_application" "my_mobile_application" {
  environment_id = pingone_environment.my_environment.id
  name           = "Mobile App"

  enabled = true

  oidc_options {
    type                        = "NATIVE_APP"
    grant_types                 = ["CLIENT_CREDENTIALS"]
    token_endpoint_authn_method = "CLIENT_SECRET_BASIC"

    mobile_app {
      bundle_id    = "org.bxretail.mobileapp"
      package_name = "org.bxretail.mobileapp"

      passcode_refresh_seconds = 45

      integrity_detection {
        enabled = true

        cache_duration {
          amount = 30
          units  = "HOURS"
        }

        google_play {
          verification_type = "INTERNAL"
          decryption_key    = var.google_play_integrity_api_decryption_key
          verification_key  = var.google_play_integrity_api_verification_key
        }
      }
    }
  }
}

resource "pingone_mfa_application_push_credential" "example_fcm" {
  environment_id = pingone_environment.my_environment.id
  application_id = pingone_application.my_mobile_application.id

  fcm {
    google_service_account_credentials = var.google_service_account_credentials_json
  }
}

resource "pingone_mfa_application_push_credential" "example_apns" {
  environment_id = pingone_environment.my_environment.id
  application_id = pingone_application.my_mobile_application.id

  apns {
    key               = var.apns_key
    team_id           = var.apns_team_id
    token_signing_key = var.apns_token_signing_key
  }
}

resource "pingone_mfa_policy" "my_awesome_mfa_policy" {
  environment_id = pingone_environment.my_environment.id
  name           = "My awesome MFA policy"

  depends_on = [
    pingone_mfa_application_push_credential.example_fcm,
    pingone_mfa_application_push_credential.example_apns,
  ]

  mobile {
    enabled = true

    otp_failure_count = 3

    application {
      id = pingone_application.my_mobile_application.id

      push_enabled = true
      otp_enabled  = true

      device_authorization_enabled            = true
      device_authorization_extra_verification = "restrictive"

      auto_enrollment_enabled = true

      integrity_detection = "restrictive"
    }
  }

  totp {
    enabled = true
  }

  fido2 {
    enabled = true
  }

  sms {
    enabled = false
  }

  voice {
    enabled = false
  }

  email {
    enabled = false
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `email` (Block List, Min: 1, Max: 1) Email OTP authentication policy settings. (see [below for nested schema](#nestedblock--email))
- `environment_id` (String) The ID of the environment to create the MFA device policy in.
- `mobile` (Block List, Min: 1, Max: 1) Mobile authenticator device policy settings.  This factor requires embedding the PingOne MFA SDK into a customer facing mobile application, and configuring as a Native application using the `pingone_application` resource. (see [below for nested schema](#nestedblock--mobile))
- `name` (String) A string that specifies the MFA policy's name.
- `sms` (Block List, Min: 1, Max: 1) SMS OTP authentication policy settings. (see [below for nested schema](#nestedblock--sms))
- `totp` (Block List, Min: 1, Max: 1) TOTP authenticator policy settings. (see [below for nested schema](#nestedblock--totp))
- `voice` (Block List, Min: 1, Max: 1) Voice OTP authentication policy settings. (see [below for nested schema](#nestedblock--voice))

### Optional

- `device_selection` (String) A string that defines the device selection method. Options are `DEFAULT_TO_FIRST` (this is the default setting for new environments), `PROMPT_TO_SELECT` and `ALWAYS_PROMPT_TO_SELECT`. Defaults to `DEFAULT_TO_FIRST`.
- `fido2` (Block List, Max: 1) FIDO2 device authentication policy settings. (see [below for nested schema](#nestedblock--fido2))
- `new_device_notification` (String) A string that defines whether a user should be notified if a new authentication method has been added to their account. Options are `NONE` (the default), `EMAIL_THEN_SMS` and `SMS_THEN_EMAIL`. Defaults to `NONE`.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--email"></a>
### Nested Schema for `email`

Required:

- `enabled` (Boolean) Enabled or disabled in the policy.

Optional:

- `otp_failure_cooldown_duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures. Note that when using the "onetime authentication" feature, the user is not blocked after the maximum number of failures even if you specified a block duration. Defaults to `0`.
- `otp_failure_cooldown_timeunit` (String) The type of time unit for `otp_failure_cooldown_duration`.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `otp_failure_count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked. Defaults to `3`.
- `otp_lifetime_duration` (Number) An integer that defines turation (number of time units) that the passcode is valid before it expires. Defaults to `30`.
- `otp_lifetime_timeunit` (String) The type of time unit for `otp_lifetime_duration`.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `pairing_disabled` (Boolean) You can set this parameter to `true` to prevent users from pairing new devices with the relevant method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices. Defaults to `false`.


<a id="nestedblock--mobile"></a>
### Nested Schema for `mobile`

Required:

- `enabled` (Boolean) Enabled or disabled in the policy.

Optional:

- `application` (Block Set) Settings for a configured Mobile Application. (see [below for nested schema](#nestedblock--mobile--application))
- `otp_failure_cooldown_duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures. Defaults to `2`.
- `otp_failure_cooldown_timeunit` (String) The type of time unit for `otp_failure_cooldown_duration`.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `otp_failure_count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked. Defaults to `3`.

<a id="nestedblock--mobile--application"></a>
### Nested Schema for `mobile.application`

Required:

- `id` (String) The mobile application's ID.  Mobile applications are configured with the `pingone_application` resource, as an OIDC `NATIVE` type.
- `otp_enabled` (Boolean) Specifies whether OTP authentication is enabled or disabled for the policy.
- `push_enabled` (Boolean) Specifies whether push notification is enabled or disabled for the policy.

Optional:

- `auto_enrollment_enabled` (Boolean) Set to `true` if you want the application to allow Auto Enrollment. Auto Enrollment means that the user can authenticate for the first time from an unpaired device, and the successful authentication will result in the pairing of the device for MFA.
- `device_authorization_enabled` (Boolean) Specifies the enabled or disabled state of automatic MFA for native devices paired with the user, for the specified application.
- `device_authorization_extra_verification` (String) Specifies the level of further verification when `device_authorization_enabled` is true. The PingOne platform performs an extra verification check by sending a "silent" push notification to the customer native application, and receives a confirmation in return.  Extra verification can be one of the following levels: `permissive`: The PingOne platform performs the extra verification check. Upon timeout or failure to get a response from the native app, the MFA step is treated as successfully completed.  `restrictive`: The PingOne platform performs the extra verification check.The PingOne platform performs the extra verification check. Upon timeout or failure to get a response from the native app, the MFA step is treated as failed.
- `integrity_detection` (String) Controls how authentication or registration attempts should proceed if a device integrity check does not receive a response. Set the value to `permissive` if you want to allow the process to continue. Set the value to `restrictive` if you want to block the user in such situations.
- `pairing_disabled` (Boolean) You can set this parameter to `true` to prevent users from pairing new devices with the relevant method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices. Defaults to `false`.
- `pairing_key_lifetime_duration` (Number) The amount of time an issued pairing key can be used until it expires. Minimum is 1 minute and maximum is 48 hours. If this parameter is not provided, the duration is set to 10 minutes. Defaults to `10`.
- `pairing_key_lifetime_timeunit` (String) The time unit for the `pairing_key_lifetime_duration` parameter.  Options are `HOURS` or `MINUTES`. Defaults to `MINUTES`.
- `push_limit_count` (Number) The number of consecutive push notifications that can be ignored or rejected by a user within a defined period before push notifications are blocked for the application. The minimum value is 1 and the maximum value is 50. If this parameter is not provided, the default value is 5. Defaults to `5`.
- `push_limit_lock_duration` (Number) The length of time that push notifications should be blocked for the application if the defined limit has been reached. The minimum value is 1 minute and the maximum value is 120 minutes. If this parameter is not provided, the default value is 30 minutes. Defaults to `30`.
- `push_limit_lock_duration_timeunit` (String) The time unit for the `push_limit_lock_duration` parameter.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `push_limit_time_period_duration` (Number) The time period in which the push notifications are counted towards the defined limit. The minimum value is 1 minute and the maximum value is 120 minutes. If this parameter is not provided, the default value is 10 minutes. Defaults to `10`.
- `push_limit_time_period_timeunit` (String) The time unit for the `push_limit_time_period_duration` parameter.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `push_timeout_duration` (Number) An integer that defines the amount of time (in seconds) a user has to respond to a push notification before it expires. Minimum is 40 seconds and maximum is 150 seconds. If this parameter is not provided, the duration is set to 40 seconds. Defaults to `40`.

Read-Only:

- `push_timeout_timeunit` (String) The time unit for the `push_timeout_duration` parameter. Currently, the only permitted value is `SECONDS`.



<a id="nestedblock--sms"></a>
### Nested Schema for `sms`

Required:

- `enabled` (Boolean) Enabled or disabled in the policy.

Optional:

- `otp_failure_cooldown_duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures. Note that when using the "onetime authentication" feature, the user is not blocked after the maximum number of failures even if you specified a block duration. Defaults to `0`.
- `otp_failure_cooldown_timeunit` (String) The type of time unit for `otp_failure_cooldown_duration`.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `otp_failure_count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked. Defaults to `3`.
- `otp_lifetime_duration` (Number) An integer that defines turation (number of time units) that the passcode is valid before it expires. Defaults to `30`.
- `otp_lifetime_timeunit` (String) The type of time unit for `otp_lifetime_duration`.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `pairing_disabled` (Boolean) You can set this parameter to `true` to prevent users from pairing new devices with the relevant method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices. Defaults to `false`.


<a id="nestedblock--totp"></a>
### Nested Schema for `totp`

Required:

- `enabled` (Boolean) Enabled or disabled in the policy.

Optional:

- `otp_failure_cooldown_duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures. Defaults to `2`.
- `otp_failure_cooldown_timeunit` (String) The type of time unit for `otp_failure_cooldown_duration`.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `otp_failure_count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked. Defaults to `3`.
- `pairing_disabled` (Boolean) You can set this parameter to `true` to prevent users from pairing new devices with the relevant method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices. Defaults to `false`.


<a id="nestedblock--voice"></a>
### Nested Schema for `voice`

Required:

- `enabled` (Boolean) Enabled or disabled in the policy.

Optional:

- `otp_failure_cooldown_duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures. Note that when using the "onetime authentication" feature, the user is not blocked after the maximum number of failures even if you specified a block duration. Defaults to `0`.
- `otp_failure_cooldown_timeunit` (String) The type of time unit for `otp_failure_cooldown_duration`.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `otp_failure_count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked. Defaults to `3`.
- `otp_lifetime_duration` (Number) An integer that defines turation (number of time units) that the passcode is valid before it expires. Defaults to `30`.
- `otp_lifetime_timeunit` (String) The type of time unit for `otp_lifetime_duration`.  Options are `MINUTES` or `SECONDS`. Defaults to `MINUTES`.
- `pairing_disabled` (Boolean) You can set this parameter to `true` to prevent users from pairing new devices with the relevant method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices. Defaults to `false`.


<a id="nestedblock--fido2"></a>
### Nested Schema for `fido2`

Required:

- `enabled` (Boolean) Enabled or disabled in the policy.

Optional:

- `fido2_policy_id` (String) Specifies the UUID that represents the FIDO2 policy in PingOne. This property can be null. When null, the environment's default FIDO2 Policy is used.
- `pairing_disabled` (Boolean) You can set this parameter to `true` to prevent users from pairing new devices with the relevant method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices. Defaults to `false`.

## Import

Import is supported using the following syntax, where attributes in `<>` brackets are replaced with the relevant ID.  For example, `<environment_id>` should be replaced with the ID of the environment to import from.

```shell
$ terraform import pingone_mfa_policy.example <environment_id>/<mfa_policy_id>
```
