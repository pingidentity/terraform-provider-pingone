---
page_title: "pingone_mfa_device_policy Resource - terraform-provider-pingone"
subcategory: "MFA"
description: |-
  Resource to create and manage MFA device policies for a PingOne environment.
---

# pingone_mfa_device_policy (Resource)

Resource to create and manage MFA device policies for a PingOne environment.

## Example Usage - Basic Policy

The following example enables the FIDO2 and TOTP Authenticator factors. 

```terraform
resource "pingone_environment" "my_environment" {
  # ...
}

resource "pingone_mfa_device_policy" "my_awesome_mfa_device_policy" {
  environment_id = pingone_environment.my_environment.id
  name           = "My awesome MFA device policy"

  mobile = {
    enabled = false
  }

  totp = {
    enabled = true
  }

  fido2 = {
    enabled = true
  }

  sms = {
    enabled = false
  }

  voice = {
    enabled = false
  }

  email = {
    enabled = false
  }
}
```

## Example Usage - Mobile Authenticator

The following example configures and enables the Mobile Authenticator (using PingOne MFA SDK) and Authenticator TOTP factors. 

```terraform
resource "pingone_environment" "my_environment" {
  # ...
}

resource "pingone_application" "my_mobile_application" {
  environment_id = pingone_environment.my_environment.id
  name           = "Mobile App"

  enabled = true

  oidc_options = {
    type                        = "NATIVE_APP"
    grant_types                 = ["CLIENT_CREDENTIALS"]
    token_endpoint_authn_method = "CLIENT_SECRET_BASIC"

    mobile_app = {
      bundle_id    = "org.bxretail.mobileapp"
      package_name = "org.bxretail.mobileapp"

      passcode_refresh_seconds = 45

      integrity_detection = {
        enabled = true

        cache_duration = {
          amount = 30
          units  = "HOURS"
        }

        google_play = {
          verification_type = "INTERNAL"
          decryption_key    = var.google_play_integrity_api_decryption_key
          verification_key  = var.google_play_integrity_api_verification_key
        }
      }
    }
  }
}

resource "pingone_mfa_application_push_credential" "example_fcm" {
  environment_id = pingone_environment.my_environment.id
  application_id = pingone_application.my_mobile_application.id

  fcm {
    google_service_account_credentials = var.google_service_account_credentials_json
  }
}

resource "pingone_mfa_application_push_credential" "example_apns" {
  environment_id = pingone_environment.my_environment.id
  application_id = pingone_application.my_mobile_application.id

  apns {
    key               = var.apns_key
    team_id           = var.apns_team_id
    token_signing_key = var.apns_token_signing_key
  }
}

resource "pingone_mfa_device_policy" "my_awesome_mfa_device_policy" {
  environment_id = pingone_environment.my_environment.id
  name           = "My awesome MFA device policy"

  depends_on = [
    pingone_mfa_application_push_credential.example_fcm,
    pingone_mfa_application_push_credential.example_apns,
  ]

  mobile = {
    enabled = true

    otp = {
      failure = {
        count = 3
      }
    }

    applications = {
      (pingone_application.my_mobile_application.id) = {

        push = {
          enabled = true
        }

        otp = {
          enabled = true
        }

        device_authorization = {
          enabled            = true
          extra_verification = "restrictive"
        }

        auto_enrollment = {
          enabled = true
        }

        integrity_detection = "restrictive"
      }
    }
  }

  totp = {
    enabled = true
  }

  fido2 = {
    enabled = true
  }

  sms = {
    enabled = false
  }

  voice = {
    enabled = false
  }

  email = {
    enabled = false
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `email` (Attributes) A single object that allows configuration of email OTP device authentication policy settings. (see [below for nested schema](#nestedatt--email))
- `environment_id` (String) The ID of the environment that contains the MFA device policy to manage.  Must be a valid PingOne resource ID.  This field is immutable and will trigger a replace plan if changed.
- `mobile` (Attributes) A single object that allows configuration of mobile push/OTP device authentication policy settings.  This factor requires embedding the PingOne MFA SDK into a customer facing mobile application, and configuring as a Native application using the `pingone_application` resource. (see [below for nested schema](#nestedatt--mobile))
- `name` (String) A string that specifies the MFA policy's unique name within the environment.
- `sms` (Attributes) A single object that allows configuration of SMS OTP device authentication policy settings. (see [below for nested schema](#nestedatt--sms))
- `totp` (Attributes) (see [below for nested schema](#nestedatt--totp))
- `voice` (Attributes) A single object that allows configuration of voice OTP device authentication policy settings. (see [below for nested schema](#nestedatt--voice))

### Optional

- `authentication` (Attributes) A single object that allows configuration of authentication settings in the device policy. (see [below for nested schema](#nestedatt--authentication))
- `fido2` (Attributes) A single object that allows configuration of FIDO2 device authentication policy settings. (see [below for nested schema](#nestedatt--fido2))
- `new_device_notification` (String) A string that defines whether a user should be notified if a new authentication method has been added to their account.  Options are `EMAIL_THEN_SMS`, `NONE`, `SMS_THEN_EMAIL`.  Defaults to `NONE`.

### Read-Only

- `default` (Boolean) A boolean that specifies whether this MFA device policy is enforced as the default within the environment. When set to `true`, all other MFA device policies are `false`.  Defaults to `false`.
- `id` (String) The ID of this resource.

<a id="nestedatt--email"></a>
### Nested Schema for `email`

Required:

- `enabled` (Boolean) A boolean that specifies whether the email OTP method is enabled or disabled in the policy.

Optional:

- `otp` (Attributes) A single object that allows configuration of email OTP settings. (see [below for nested schema](#nestedatt--email--otp))
- `pairing_disabled` (Boolean) A boolean that, when set to `true`, prevents users from pairing new devices with the email OTP method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices.  Defaults to `false`.
- `prompt_for_nickname_on_pairing` (Boolean) A boolean that, when set to `true`, prompts users to provide nicknames for devices during pairing.

<a id="nestedatt--email--otp"></a>
### Nested Schema for `email.otp`

Optional:

- `failure` (Attributes) A single object that allows configuration of email OTP failure settings. (see [below for nested schema](#nestedatt--email--otp--failure))
- `lifetime` (Attributes) A single object that allows configuration of email OTP lifetime settings. (see [below for nested schema](#nestedatt--email--otp--lifetime))

<a id="nestedatt--email--otp--failure"></a>
### Nested Schema for `email.otp.failure`

Required:

- `cool_down` (Attributes) A single object that allows configuration of email OTP failure cool down settings. (see [below for nested schema](#nestedatt--email--otp--failure--cool_down))
- `count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked.

<a id="nestedatt--email--otp--failure--cool_down"></a>
### Nested Schema for `email.otp.failure.count`

Required:

- `duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.



<a id="nestedatt--email--otp--lifetime"></a>
### Nested Schema for `email.otp.lifetime`

Required:

- `duration` (Number) An integer that defines the duration (number of time units) that the passcode is valid before it expires.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.




<a id="nestedatt--mobile"></a>
### Nested Schema for `mobile`

Required:

- `enabled` (Boolean) A boolean that specifies whether the mobile device method is enabled or disabled in the policy.

Optional:

- `applications` (Attributes Map) A map of objects that specifies settings for a configured Mobile Application.  The ID of the application should be configured as the map key. (see [below for nested schema](#nestedatt--mobile--applications))
- `otp` (Attributes) A single object that specifies OTP settings for mobile applications in the policy. (see [below for nested schema](#nestedatt--mobile--otp))
- `prompt_for_nickname_on_pairing` (Boolean) A boolean that, when set to `true`, prompts users to provide nicknames for devices during pairing.

<a id="nestedatt--mobile--applications"></a>
### Nested Schema for `mobile.applications`

Optional:

- `auto_enrollment` (Attributes) A single object that specifies auto enrollment settings for the application in the policy. (see [below for nested schema](#nestedatt--mobile--applications--auto_enrollment))
- `device_authorization` (Attributes) A single object that specifies device authorization settings for the application in the policy. (see [below for nested schema](#nestedatt--mobile--applications--device_authorization))
- `integrity_detection` (String) Controls how authentication or registration attempts should proceed if a device integrity check does not receive a response.  Options are `permissive` (if you want to allow the process to continue if a device integrity check does not receive a response), `restrictive` (if you want to block the user if a device integrity check does not receive a response).
- `otp` (Attributes) A single object that specifies OTP settings for the application in the policy. (see [below for nested schema](#nestedatt--mobile--applications--otp))
- `pairing_disabled` (Boolean) A boolean that, when set to `true`, prevents users from pairing new devices with the relevant application. You can use this option if you want to phase out an existing mobile application but want to allow users to continue using the application for authentication for existing devices.
- `pairing_key_lifetime` (Attributes) A single object that specifies pairing key lifetime settings for the application in the policy. (see [below for nested schema](#nestedatt--mobile--applications--pairing_key_lifetime))
- `push` (Attributes) A single object that specifies push settings for the application in the policy. (see [below for nested schema](#nestedatt--mobile--applications--push))
- `push_limit` (Attributes) A single object that specifies push limit settings for the application in the policy. (see [below for nested schema](#nestedatt--mobile--applications--push_limit))
- `push_timeout` (Attributes) A single object that specifies push timeout settings for the application in the policy. (see [below for nested schema](#nestedatt--mobile--applications--push_timeout))

<a id="nestedatt--mobile--applications--auto_enrollment"></a>
### Nested Schema for `mobile.applications.auto_enrollment`

Required:

- `enabled` (Boolean) A boolean that, when set to `true` if you want the application to allow Auto Enrollment. Auto Enrollment means that the user can authenticate for the first time from an unpaired device, and the successful authentication will result in the pairing of the device for MFA.


<a id="nestedatt--mobile--applications--device_authorization"></a>
### Nested Schema for `mobile.applications.device_authorization`

Required:

- `enabled` (Boolean) Specifies the enabled or disabled state of automatic MFA for native devices paired with the user, for the specified application.

Optional:

- `extra_verification` (String) Specifies the level of further verification when device authorization is enabled. The PingOne platform performs an extra verification check by sending a "silent" push notification to the customer native application, and receives a confirmation in return.  By default, the PingOne platform does not perform the extra verification check.  Options are `permissive` (the PingOne platform performs the extra verification check. Upon timeout or failure to get a response from the native app, the MFA step is treated as successfully completed), `restrictive` (the PingOne platform performs the extra verification check. Upon timeout or failure to get a response from the native app, the MFA step is treated as failed).


<a id="nestedatt--mobile--applications--otp"></a>
### Nested Schema for `mobile.applications.otp`

Required:

- `enabled` (Boolean) A boolean that specifies whether OTP authentication is enabled or disabled for the application in the policy.


<a id="nestedatt--mobile--applications--pairing_key_lifetime"></a>
### Nested Schema for `mobile.applications.pairing_key_lifetime`

Required:

- `duration` (Number) An integer that defines the amount of time an issued pairing key can be used until it expires. Minimum is 1 minute and maximum is 48 hours. If this parameter is not provided, the duration is set to 10 minutes.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `HOURS`, `MINUTES`.


<a id="nestedatt--mobile--applications--push"></a>
### Nested Schema for `mobile.applications.push`

Required:

- `enabled` (Boolean) A boolean that specifies whether push notification is enabled or disabled for the application in the policy.


<a id="nestedatt--mobile--applications--push_limit"></a>
### Nested Schema for `mobile.applications.push_limit`

Optional:

- `count` (Number) An integer that specifies the number of consecutive push notifications that can be ignored or rejected by a user within a defined period before push notifications are blocked for the application. The minimum value is "1" and the maximum value is "50". If this parameter is not provided, the default value is "5".
- `lock_duration` (Attributes) A single object that specifies push limit lock duration settings for the application in the policy. (see [below for nested schema](#nestedatt--mobile--applications--push_limit--lock_duration))
- `time_period` (Attributes) A single object that specifies push limit time period settings for the application in the policy. (see [below for nested schema](#nestedatt--mobile--applications--push_limit--time_period))

<a id="nestedatt--mobile--applications--push_limit--lock_duration"></a>
### Nested Schema for `mobile.applications.push_limit.time_period`

Required:

- `duration` (Number) An integer that defines the length of time that push notifications should be blocked for the application if the defined limit has been reached. The minimum value is `1` minute and the maximum value is `120` minutes. If this parameter is not provided, the default value is `30` minutes.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.


<a id="nestedatt--mobile--applications--push_limit--time_period"></a>
### Nested Schema for `mobile.applications.push_limit.time_period`

Required:

- `duration` (Number) An integer that defines the length of time that push notifications should be blocked for the application if the defined limit has been reached. The minimum value is `1` minute and the maximum value is `120` minutes. If this parameter is not provided, the default value is `30` minutes.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.



<a id="nestedatt--mobile--applications--push_timeout"></a>
### Nested Schema for `mobile.applications.push_timeout`

Required:

- `duration` (Number) An integer that defines the length of time that push notifications should be blocked for the application if the defined limit has been reached. The minimum value is `1` minute and the maximum value is `120` minutes. If this parameter is not provided, the default value is `30` minutes.

Optional:

- `time_unit` (String) A string that specifies the type of time unit for `duration`. Currently, the only permitted value is `SECONDS`.  Defaults to `SECONDS`.



<a id="nestedatt--mobile--otp"></a>
### Nested Schema for `mobile.otp`

Required:

- `failure` (Attributes) A single object that specifies OTP failure settings for mobile applications in the policy. (see [below for nested schema](#nestedatt--mobile--otp--failure))

<a id="nestedatt--mobile--otp--failure"></a>
### Nested Schema for `mobile.otp.failure`

Optional:

- `cool_down` (Attributes) A single object that specifies OTP failure cool down settings for mobile applications in the policy. (see [below for nested schema](#nestedatt--mobile--otp--failure--cool_down))
- `count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked. The minimum value is `1`, maximum is `7`, and the default is `3`.

<a id="nestedatt--mobile--otp--failure--cool_down"></a>
### Nested Schema for `mobile.otp.failure.count`

Required:

- `duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures. The minimum value is `2`, maximum is `30`, and the default is `2`. Note that when using the "onetime authentication" feature, the user is not blocked after the maximum number of failures even if you specified a block duration.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.





<a id="nestedatt--sms"></a>
### Nested Schema for `sms`

Required:

- `enabled` (Boolean) A boolean that specifies whether the SMS OTP method is enabled or disabled in the policy.

Optional:

- `otp` (Attributes) A single object that allows configuration of SMS OTP settings. (see [below for nested schema](#nestedatt--sms--otp))
- `pairing_disabled` (Boolean) A boolean that, when set to `true`, prevents users from pairing new devices with the SMS OTP method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices.  Defaults to `false`.
- `prompt_for_nickname_on_pairing` (Boolean) A boolean that, when set to `true`, prompts users to provide nicknames for devices during pairing.

<a id="nestedatt--sms--otp"></a>
### Nested Schema for `sms.otp`

Optional:

- `failure` (Attributes) A single object that allows configuration of SMS OTP failure settings. (see [below for nested schema](#nestedatt--sms--otp--failure))
- `lifetime` (Attributes) A single object that allows configuration of SMS OTP lifetime settings. (see [below for nested schema](#nestedatt--sms--otp--lifetime))

<a id="nestedatt--sms--otp--failure"></a>
### Nested Schema for `sms.otp.failure`

Required:

- `cool_down` (Attributes) A single object that allows configuration of SMS OTP failure cool down settings. (see [below for nested schema](#nestedatt--sms--otp--failure--cool_down))
- `count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked.

<a id="nestedatt--sms--otp--failure--cool_down"></a>
### Nested Schema for `sms.otp.failure.count`

Required:

- `duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.



<a id="nestedatt--sms--otp--lifetime"></a>
### Nested Schema for `sms.otp.lifetime`

Required:

- `duration` (Number) An integer that defines the duration (number of time units) that the passcode is valid before it expires.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.




<a id="nestedatt--totp"></a>
### Nested Schema for `totp`

Required:

- `enabled` (Boolean) A boolean that specifies whether the TOTP method is enabled or disabled in the policy.

Optional:

- `otp` (Attributes) A single object that allows configuration of TOTP OTP settings. (see [below for nested schema](#nestedatt--totp--otp))
- `pairing_disabled` (Boolean) A boolean that, when set to `true`, prevents users from pairing new devices with the TOTP method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices.  Defaults to `false`.
- `prompt_for_nickname_on_pairing` (Boolean) A boolean that, when set to `true`, prompts users to provide nicknames for devices during pairing.

<a id="nestedatt--totp--otp"></a>
### Nested Schema for `totp.otp`

Optional:

- `failure` (Attributes) A single object that allows configuration of TOTP OTP failure settings. (see [below for nested schema](#nestedatt--totp--otp--failure))

<a id="nestedatt--totp--otp--failure"></a>
### Nested Schema for `totp.otp.failure`

Required:

- `count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked.

Optional:

- `cool_down` (Attributes) A single object that allows configuration of TOTP OTP failure cool down settings. (see [below for nested schema](#nestedatt--totp--otp--failure--cool_down))

<a id="nestedatt--totp--otp--failure--cool_down"></a>
### Nested Schema for `totp.otp.failure.cool_down`

Required:

- `duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.





<a id="nestedatt--voice"></a>
### Nested Schema for `voice`

Required:

- `enabled` (Boolean) A boolean that specifies whether the voice OTP method is enabled or disabled in the policy.

Optional:

- `otp` (Attributes) A single object that allows configuration of voice OTP settings. (see [below for nested schema](#nestedatt--voice--otp))
- `pairing_disabled` (Boolean) A boolean that, when set to `true`, prevents users from pairing new devices with the voice OTP method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices.  Defaults to `false`.
- `prompt_for_nickname_on_pairing` (Boolean) A boolean that, when set to `true`, prompts users to provide nicknames for devices during pairing.

<a id="nestedatt--voice--otp"></a>
### Nested Schema for `voice.otp`

Optional:

- `failure` (Attributes) A single object that allows configuration of voice OTP failure settings. (see [below for nested schema](#nestedatt--voice--otp--failure))
- `lifetime` (Attributes) A single object that allows configuration of voice OTP lifetime settings. (see [below for nested schema](#nestedatt--voice--otp--lifetime))

<a id="nestedatt--voice--otp--failure"></a>
### Nested Schema for `voice.otp.failure`

Required:

- `cool_down` (Attributes) A single object that allows configuration of voice OTP failure cool down settings. (see [below for nested schema](#nestedatt--voice--otp--failure--cool_down))
- `count` (Number) An integer that defines the maximum number of times that the OTP entry can fail for a user, before they are blocked.

<a id="nestedatt--voice--otp--failure--cool_down"></a>
### Nested Schema for `voice.otp.failure.count`

Required:

- `duration` (Number) An integer that defines the duration (number of time units) the user is blocked after reaching the maximum number of passcode failures.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.



<a id="nestedatt--voice--otp--lifetime"></a>
### Nested Schema for `voice.otp.lifetime`

Required:

- `duration` (Number) An integer that defines the duration (number of time units) that the passcode is valid before it expires.
- `time_unit` (String) A string that specifies the type of time unit for `duration`.  Options are `MINUTES`, `SECONDS`.




<a id="nestedatt--authentication"></a>
### Nested Schema for `authentication`

Optional:

- `device_selection` (String) A string that defines the device selection method.  Options are `ALWAYS_DISPLAY_DEVICES`, `DEFAULT_TO_FIRST`, `PROMPT_TO_SELECT`.  Defaults to `DEFAULT_TO_FIRST`.


<a id="nestedatt--fido2"></a>
### Nested Schema for `fido2`

Required:

- `enabled` (Boolean) A boolean that specifies whether the FIDO2 method is enabled or disabled in the policy.

Optional:

- `fido2_policy_id` (String) A string that specifies the resource UUID that represents the FIDO2 policy in PingOne. This property can be null / left undefined. When null, the environment's default FIDO2 Policy is used.  Must be a valid PingOne resource ID.
- `pairing_disabled` (Boolean) A boolean that, when set to `true`, prevents users from pairing new devices with the FIDO2 method, though keeping it active in the policy for existing users. You can use this option if you want to phase out an existing authentication method but want to allow users to continue using the method for authentication for existing devices.  Defaults to `false`.
- `prompt_for_nickname_on_pairing` (Boolean) A boolean that, when set to `true`, prompts users to provide nicknames for devices during pairing.

## Import

Import is supported using the following syntax, where attributes in `<>` brackets are replaced with the relevant ID.  For example, `<environment_id>` should be replaced with the ID of the environment to import from.

```shell
terraform import pingone_mfa_device_policy.example <environment_id>/<mfa_device_policy_id>
```
